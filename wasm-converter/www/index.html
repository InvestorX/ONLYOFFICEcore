<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WASM ドキュメントコンバーター</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>📄 WASM ドキュメントコンバーター</h1>
            <p>ブラウザ上でドキュメントをPDFや画像に変換 — Rust + WebAssembly</p>
        </header>

        <div class="card">
            <h2>🔤 フォント管理</h2>
            <p style="font-size: 0.85rem; color: var(--text-muted); margin-bottom: 1rem;">
                外部フォント（.ttf, .otf）を読み込むことで描画の再現性が向上します。<br>
                内蔵フォント: Noto Sans JP / LINE Seed JP（embed-fontsフィーチャーでビルド時に埋め込み）
            </p>
            <div class="drop-zone" id="fontDropZone" style="padding: 1.5rem 1rem;">
                <div class="icon" style="font-size: 2rem;">🔤</div>
                <p>フォントファイルをドラッグ＆ドロップ、またはクリックして追加</p>
                <p class="formats">.ttf, .otf ファイル対応</p>
            </div>
            <input type="file" id="fontFileInput" accept=".ttf,.otf" multiple>
            <div id="fontList" style="margin-top: 0.75rem;"></div>
            <div style="margin-top: 0.75rem;">
                <label style="font-size: 0.85rem; font-weight: 600; margin-bottom: 0.5rem; display: block;">
                    URLからフォントを読み込み
                </label>
                <div style="display: flex; gap: 0.5rem;">
                    <input type="text" id="fontUrl" placeholder="https://example.com/font.ttf"
                           style="flex: 1; padding: 0.5rem; border: 1px solid var(--border); border-radius: 6px; font-size: 0.85rem;">
                    <input type="text" id="fontUrlName" placeholder="フォント名"
                           style="width: 150px; padding: 0.5rem; border: 1px solid var(--border); border-radius: 6px; font-size: 0.85rem;">
                    <button class="btn btn-primary" id="loadFontUrl" style="padding: 0.5rem 1rem; font-size: 0.85rem;">
                        読み込み
                    </button>
                </div>
            </div>
        </div>

        <div class="card">
            <h2>📁 ファイル選択</h2>
            <div class="drop-zone" id="dropZone">
                <div class="icon">📎</div>
                <p>ファイルをドラッグ＆ドロップ、またはクリックして選択</p>
                <p class="formats">対応形式: DOC, DOCX, ODT, RTF, TXT, EPUB, XPS, DjVu, XLS, XLSX, ODS, CSV, PPT, PPTX, ODP</p>
            </div>
            <input type="file" id="fileInput" accept=".doc,.docx,.odt,.rtf,.txt,.epub,.xps,.djvu,.djv,.xls,.xlsx,.ods,.csv,.ppt,.pptx,.odp">
            <div id="fileInfo" style="display:none" class="file-info">
                <span class="icon">📄</span>
                <div class="details">
                    <div class="name" id="fileName"></div>
                    <div class="size" id="fileSize"></div>
                </div>
                <button class="remove" id="removeFile" title="ファイルを削除">✕</button>
            </div>
        </div>

        <div class="card">
            <h2>⚙️ 変換設定</h2>
            <div class="options">
                <div class="option-group">
                    <label for="outputFormat">出力形式</label>
                    <select id="outputFormat">
                        <option value="pdf">📕 PDF（単一ファイル）</option>
                        <option value="images_zip">🖼️ 画像（ZIP）— ページごとにPNG</option>
                    </select>
                </div>
                <div class="option-group" id="dpiGroup">
                    <label for="dpiInput">解像度 (DPI)</label>
                    <input type="number" id="dpiInput" value="150" min="72" max="600" step="1">
                </div>
            </div>
            <div class="btn-group">
                <button class="btn btn-primary" id="convertBtn" disabled>
                    🔄 変換する
                </button>
            </div>
            <div class="progress-bar" id="progressBar">
                <div class="fill" style="width: 100%"></div>
            </div>
            <div class="status" id="status"></div>
        </div>

        <div class="card">
            <h2>📋 対応フォーマット一覧</h2>
            <table class="formats-table">
                <thead>
                    <tr><th>フォーマット</th><th>拡張子</th><th>状態</th></tr>
                </thead>
                <tbody>
                    <tr><td>テキスト</td><td>.txt</td><td><span class="badge full">完全対応</span></td></tr>
                    <tr><td>CSV</td><td>.csv</td><td><span class="badge full">完全対応</span></td></tr>
                    <tr><td>RTF</td><td>.rtf</td><td><span class="badge partial">テキスト抽出</span></td></tr>
                    <tr><td>Microsoft Word</td><td>.docx</td><td><span class="badge full">レイアウト保持</span></td></tr>
                    <tr><td>Microsoft Word (旧)</td><td>.doc</td><td><span class="badge stub">開発中</span></td></tr>
                    <tr><td>OpenDocument Text</td><td>.odt</td><td><span class="badge stub">開発中</span></td></tr>
                    <tr><td>EPUB</td><td>.epub</td><td><span class="badge stub">開発中</span></td></tr>
                    <tr><td>XPS</td><td>.xps</td><td><span class="badge stub">開発中</span></td></tr>
                    <tr><td>DjVu</td><td>.djvu</td><td><span class="badge stub">開発中</span></td></tr>
                    <tr><td>Microsoft Excel</td><td>.xlsx, .xls, .ods</td><td><span class="badge full">テーブル表示</span></td></tr>
                    <tr><td>Microsoft PowerPoint</td><td>.pptx</td><td><span class="badge full">レイアウト保持</span></td></tr>
                    <tr><td>Microsoft PowerPoint (旧)</td><td>.ppt</td><td><span class="badge stub">開発中</span></td></tr>
                    <tr><td>OpenDocument Presentation</td><td>.odp</td><td><span class="badge stub">開発中</span></td></tr>
                </tbody>
            </table>
        </div>

        <footer>
            <p>WASM Document Converter — Powered by Rust + WebAssembly</p>
            <p>日本語フォント内蔵対応（Noto Sans JP / LINE Seed JP）+ 外部フォント実行時読み込み</p>
        </footer>
    </div>

    <script type="module" src="main.js"></script>
</body>
</html>
